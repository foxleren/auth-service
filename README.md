# auth-service
## Тестовое задание  на позицию "инженер ИБ". Выполнил Мохов Сергей Александрович.

## Требования к ИБ

* У пользователя должна быть возможность визуально скрыть пароль от посторонних
* Необходима валидация на заполнение обязательных полей, проверка соотвествия типа вводимых данных и ожидаемых
* Пароль должен храниться в строго зашифрованном виде. Например, можно использовать sha-256 
* Необходимо добавлять индивидуальные соли при хэшировании для повышения безопасности
* Следует задать ограничения на возможный пароль на бэкенде и не полагаться только на фронтенд
* Необходимо отправлять запрос по https, используя защищенный протокол передачи данных
* В случае неудачной попытки входа в систему нельзя конкретизировать в чем именно не совпадение с базой данных. Необходимо сообщать о некорректных данных в целом
* В идеале реализовать двухфакторную систему аутентификации
* Необходимо обезопасить код бэкенда от sql инъекций. Например, с помощью экранирования

## Backend

Реализован на Golang. В качестве СУБД используется PostgreSQL.

### Особенности функционала

* Релизован интерфейс Auth, отвечающий за аутентификацию и авторизацию.
* Реализована работа  с JWT.
* Пароли хранятся только в хешированном виде.
* Выполняется хэширование паролей с дополнительными ключами SALT_KEY, SIGNING_KEY
* Реализована логика восстановления пароля (новый пароль приходит на почту, которая привязана к учетной записи).

### .env
```
DB_PASSWORD=<password>
SALT_KEY=<salt_key>
SIGNING_KEY=<signing_key>
DOMAIN=<domain>

SMTP_EMAIL=<email>
SMTP_PASSWORD=<password>
```

### configs/config.yml
```
port: "8000"

db:
  host: "localhost"
  port: "5432"
  username: "postgres"
  dbname: "postgres"
  sslmode: "disable"

smtp:
  host: "smtp.yandex.ru"
  port: "25"
```

### API

/auth/sign-up
```
localhost:8000/api/auth/sign-up
```
```
{
	"email": "user@gmail.com",
	"password": "qwerty"
}
```
/auth/sign-in
```
localhost:8000/api/auth/sign-in
```
```
{
	"email": "user@gmail.com",
	"password": "qwerty"
}
```
/auth/reset-password
```
localhost:8000/api/auth/reset-password
```
```
{
	"email": "user@gmail.com"
}
```

### Формат данных в БД.
Таблица **users**
```
CREATE TABLE users
(
    id            serial       not null unique,
    email         varchar(255) not null unique,
    password_hash varchar(255) not null
);
```

## Frontend

Реализован на React.js, дополнительно используется mobx для хранения текущего статуса пользователя.

Реализованы следующие страницы:

### Страница: Вход в аккаунт

![image](https://github.com/foxleren/auth-service/assets/64990498/082fcc16-269d-4d6b-852f-6315b4dad12a)

1. В случае ошибки сервера пользователь получает уведомление.

![image](https://github.com/foxleren/auth-service/assets/64990498/a37ba14b-2f66-429d-8678-43686ecf1351)

2. В случае, если пароль или логин не подошли, то сообщается о некорректных данных, но не конкретезируется конкретный параметр разхожодения с целью повышения безопасности.

![image](https://github.com/foxleren/auth-service/assets/64990498/4074d11b-1e0d-485f-9c27-2f2c7ac39b1a)

3. В случае, если аутентификация и авторизация прошли успешно, пользователь перенаправляется на домашнюю страницу.

### Страница: Восстановление пароля

![image](https://github.com/foxleren/auth-service/assets/64990498/dc8e9ad3-3edc-4d19-945a-0f029085003d)

1. В случае ошибки сервера пользователь получает уведомление.

![image](https://github.com/foxleren/auth-service/assets/64990498/630801d1-10d1-4d9b-90ea-120089e8e087)

2. В случае, если пользователя с таким логином не существует, то появляется уведомление.
![image](https://github.com/foxleren/auth-service/assets/64990498/eccdb64c-eea7-4c8c-a9ec-a51ecf905b76)

2. В случае, если новый пароль уже сгенерирован и направлен на почту пользователя, пользователь получает уведомление.

### Страница: Домашний экран (пользователь авторизован)

Доступен только авторизованным пользователям.

Доступна кнопка Выход из аккаунта, при нажатии на которую происходит очистка кэша и разлогинивание из системы.
